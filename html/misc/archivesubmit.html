<!-- TEMPLATE pre -->
<link rel="stylesheet" type="text/css" href="/cloudtube/youtube.css">
<title>YouTube annotations archive channel submitter</title>
<script src="/cloudtube/cloudtube.js"></script>
<script>
    function keydown(event) {
        if (event.key == "Enter" && event.ctrlKey) submitToArchive();
    }

    function submitToArchive() {
        let channels = q("#iChannelName").value.split("\n");
        channels = channels.map(c => {
            if (c.startsWith("http")) {
                let fragments = c.split("/");
                while (["home", "videos", "playlists", "community", "channels", "about"].includes(fragments.slice(-1)[0])) fragments.pop();
                return fragments.slice(-1)[0];
            }
            return c;
        });
        channels = channels.filter(c => c);
        q("#iChannelName").value = "";
        q("#iChannelName").focus();
        if (!channels[0]) return;
        let objects = channels.map(text => ({text}));
        let insertBeforeMarker = q("#tLog").firstChild;
        for (let object of objects) {
            object.tr = document.createElement("tr");
            object.tr.innerHTML = `<td>${object.text}</td><td>pending...</td>`;
            q("#tLog").insertBefore(object.tr, insertBeforeMarker);
        }
        request("/api/youtube/archive/channels", response => {
            let data = JSON.parse(response.responseText);
            for (let object of objects) {
                object.tr.children[1].innerText = data[object.text];
            }
        }, channels);
    }
</script>
<style>
    #iChannelName {
        width: 550px;
        height: 227px;
        font-family: 'Liberation Mono',monospace;
        font-size: 13px;
    }
    table {
        margin-top: 10px;
    }
</style>
<!-- TEMPLATE header -->
<h1>YouTube annotations archive channel submitter</h1>
<h2>What is this?</h2>
<p>YouTube will be deleting all annotations on January 15th.</p>
<p>
    Most people remember annotations as overlays that creators put in videos to annoy you, or to take you somewhere you don't want to go
    when you click the video to pause it, but they were actually so much more.
    <a href="https://waxy.org/2018/11/a-tribute-to-youtube-annotations/">Here's an article</a> showing off the life and death
    of annotations and some of the many creative uses they had.
</p>
<p>
    You can contribute to the archiving effort by running your own worker server to help archive annotation data
    (<a href="https://www.reddit.com/r/DataHoarder/comments/aa6czg/youtube_annotation_archive/">instructions</a>
    / <a href="https://github.com/omarroth/archive">github</a>
    / <a href="https://discord.gg/dP4Pu6d">discord</a>),<br>
    but another way that you can help is by bringing to our attention some specific channels that you'd like to be archived.
</p>
<h2>How do I submit channels?</h2>
<p>If there's a creator that you are a fan of, enter their YouTube username, channel ID, or channel URL here, and they'll be added to the archive.</p>
<p>One ID/name per line. Use Ctrl-Enter to submit.</p>
<div><textarea id="iChannelName" autofocus placeholder="Type some channels here" onkeydown="keydown(event)"></textarea></div>
<button onclick="submitToArchive()">Submit</button>
<table>
    <thead>
        <tr>
            <td style="min-width: 250px;">Channel</td>
            <td style="min-width: 150px;">Status</td>
        </tr>
    </thead>
    <tbody id="tLog">
    </tbody>
</table>
<div style="height: 25%;"></div>
<!-- TEMPLATE end -->